import{m as P,u as J,r as u,p as w,g as $,q as E,h as K,o as p,c as b,a as e,t as l,b as c,s as R,F as V,k as F,l as A,j as Q,n as U}from"./index-c7fd5851.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const H={class:"quiz-page py-4"},W={class:"container"},X={class:"d-flex justify-content-between align-items-center mb-4"},Y={class:"d-flex align-items-center"},Z={class:"text-muted mb-0"},ee={class:"d-flex gap-2"},te={class:"timer-badge"},se={key:0,class:"quiz-content"},ae={class:"progress mb-4",style:{height:"8px"}},ie={class:"card border-0 shadow-sm mb-4"},le={class:"card-body p-4"},oe={class:"d-flex justify-content-between align-items-center mb-3"},ne={class:"card-title mb-0"},re={class:"badge bg-primary"},ue={class:"question-text mb-4"},de={class:"options-list"},ce=["onClick"],me={class:"option-marker"},ve={class:"option-text"},pe={class:"d-flex justify-content-between"},be=["disabled"],ge=["disabled"],fe={key:1,class:"text-center py-5"},_e={key:2,class:"results-content text-center"},ye={class:"card border-0 shadow-sm"},he={class:"card-body p-5"},ke={class:"text-muted mb-4"},xe={class:"d-flex justify-content-center gap-3"},we={__name:"Quiz",setup(Se){const C=P(),k=J(),a=u([]),o=u(0),n=u(null),m=u(!1),_=u(!1),x=u(0),y=u(600);let g=null;const S=u({title:"Loading...",id:null}),f=w(()=>!a.value||a.value.length===0?{text:"Tidak ada pertanyaan",options:[],correctAnswer:0,points:0}:a.value[o.value]||{text:"Tidak ada pertanyaan",options:[],correctAnswer:0,points:0}),I=w(()=>a.value.length>0&&o.value===a.value.length-1),j=w(()=>a.value.reduce((s,t)=>s+(t.points||0),0));$(async()=>{try{const s=parseInt(C.query.materi);if(console.log("Loading quiz for material:",s),!s||isNaN(s)){console.error("Invalid material ID"),k.push("/dashboard");return}console.log("Checking localStorage...");const t=localStorage.getItem("questions");if(console.log("Current questions in localStorage:",t),!t){console.log("Initializing dummy questions...");const i=[{materialId:101,text:"Apa itu variabel dalam aljabar?",options:["Huruf yang mewakili nilai","Angka tetap","Operator matematika","Simbol geometri"],correctAnswer:0,points:10},{materialId:101,text:"Berapakah hasil dari 2x + 3 = 7?",options:["x = 2","x = 3","x = 4","x = 5"],correctAnswer:0,points:10},{materialId:102,text:"Berapakah jumlah sudut pada segitiga?",options:["90째","180째","270째","360째"],correctAnswer:1,points:10},{materialId:102,text:"Bentuk geometri yang memiliki 4 sisi sama panjang adalah?",options:["Persegi","Segitiga","Lingkaran","Trapesium"],correctAnswer:0,points:10}];localStorage.setItem("questions",JSON.stringify(i)),alert("Data soal berhasil diinisialisasi!"),console.log("Dummy questions initialized:",i)}const r=localStorage.getItem("materials");if(console.log("Current materials in localStorage:",r),!r){console.log("Initializing dummy materials...");const i=[{id:101,title:"Pengenalan Aljabar",subjectId:1},{id:102,title:"Geometri Dasar",subjectId:1}];localStorage.setItem("materials",JSON.stringify(i)),alert("Data materi berhasil diinisialisasi!"),console.log("Dummy materials initialized:",i)}const d=localStorage.getItem("materials");if(d){const v=JSON.parse(d).find(O=>O.id===s);if(v)S.value=v,console.log("Loaded material:",v);else{console.warn("Material not found:",s),alert("Materi tidak ditemukan!"),k.push("/dashboard");return}}const h=localStorage.getItem("questions");if(h){const i=JSON.parse(h);a.value=i.filter(v=>v.materialId===s),console.log("Loaded questions for material:",s,a.value)}a.value.length===0&&(console.warn("No questions found for material:",s),alert("Belum ada soal untuk materi ini!"),a.value=[]),q()}catch(s){console.error("Error initializing quiz:",s),alert("Terjadi kesalahan saat memuat kuis!"),a.value=[]}}),E(()=>{g&&clearInterval(g)});const q=()=>{g=setInterval(()=>{y.value>0?y.value--:z()},1e3)},D=s=>{const t=Math.floor(s/60),r=s%60;return`${t}:${r.toString().padStart(2,"0")}`},N=s=>{m.value||(n.value=s)},L=()=>{o.value>0&&(o.value--,n.value=null,m.value=!1)},B=()=>{I.value?z():(o.value++,n.value=null,m.value=!1)},z=()=>{_.value=!0,g&&clearInterval(g),x.value=a.value.reduce((s,t,r)=>{const d=n.value;return s+(d===t.correctAnswer?t.points:0)},0)},M=()=>{o.value=0,n.value=null,m.value=!1,_.value=!1,x.value=0,y.value=600,q()},T=()=>{confirm("Apakah Anda yakin ingin keluar dari quiz? Progress Anda akan hilang.")&&k.push("/dashboard")};return(s,t)=>{var d;const r=K("router-link");return p(),b("div",H,[e("div",W,[e("div",X,[e("div",Y,[t[1]||(t[1]=e("i",{class:"bi bi-pencil-square display-4 text-primary me-3"},null,-1)),e("div",null,[t[0]||(t[0]=e("h1",{class:"mb-0"},"Quiz",-1)),e("p",Z,l(((d=S.value)==null?void 0:d.title)||"Loading..."),1)])]),e("div",ee,[e("div",te,[t[2]||(t[2]=e("i",{class:"bi bi-clock me-2"},null,-1)),c(" "+l(D(y.value)),1)]),e("button",{onClick:T,class:"btn btn-outline-danger"},t[3]||(t[3]=[e("i",{class:"bi bi-x-circle me-2"},null,-1),c("Keluar ")]))])]),!_.value&&a.value&&a.value.length>0?(p(),b("div",se,[e("div",ae,[e("div",{class:"progress-bar bg-primary",style:R({width:`${(o.value+1)/a.value.length*100}%`})},null,4)]),e("div",ie,[e("div",le,[e("div",oe,[e("h5",ne,"Pertanyaan "+l(o.value+1)+" dari "+l(a.value.length),1),e("span",re,l(f.value.points||0)+" poin",1)]),e("p",ue,l(f.value.text),1),e("div",de,[(p(!0),b(V,null,F(f.value.options||[],(h,i)=>(p(),b("div",{key:i,class:U(["option-item",{selected:n.value===i,correct:m.value&&i===f.value.correctAnswer,incorrect:m.value&&n.value===i&&i!==f.value.correctAnswer}]),onClick:v=>N(i)},[e("div",me,l(String.fromCharCode(65+i)),1),e("div",ve,l(h),1)],10,ce))),128))])])]),e("div",pe,[e("button",{class:"btn btn-outline-primary",onClick:L,disabled:o.value===0},t[4]||(t[4]=[e("i",{class:"bi bi-arrow-left me-2"},null,-1),c("Sebelumnya ")]),8,be),e("button",{class:"btn btn-primary",onClick:B,disabled:!n.value},[c(l(I.value?"Selesai":"Selanjutnya")+" ",1),t[5]||(t[5]=e("i",{class:"bi bi-arrow-right ms-2"},null,-1))],8,ge)])])):_.value?(p(),b("div",_e,[e("div",ye,[e("div",he,[t[12]||(t[12]=e("i",{class:"bi bi-trophy display-1 text-warning mb-4"},null,-1)),t[13]||(t[13]=e("h2",{class:"mb-3"},"Quiz Selesai!",-1)),e("p",ke,"Skor Anda: "+l(x.value)+" dari "+l(j.value)+" poin",1),e("div",xe,[e("button",{onClick:M,class:"btn btn-primary"},t[10]||(t[10]=[e("i",{class:"bi bi-arrow-repeat me-2"},null,-1),c("Ulangi Quiz ")])),A(r,{to:"/dashboard",class:"btn btn-outline-primary"},{default:Q(()=>t[11]||(t[11]=[e("i",{class:"bi bi-house me-2"},null,-1),c("Kembali ke Dashboard ")])),_:1})])])])])):(p(),b("div",fe,[t[7]||(t[7]=e("i",{class:"bi bi-exclamation-circle display-1 text-muted mb-3"},null,-1)),t[8]||(t[8]=e("h3",null,"Belum ada soal",-1)),t[9]||(t[9]=e("p",{class:"text-muted"},"Soal untuk materi ini belum tersedia.",-1)),A(r,{to:"/dashboard",class:"btn btn-primary mt-3"},{default:Q(()=>t[6]||(t[6]=[e("i",{class:"bi bi-arrow-left me-2"},null,-1),c("Kembali ke Dashboard ")])),_:1})]))])])}}},ze=G(we,[["__scopeId","data-v-69e17982"]]);export{ze as default};
